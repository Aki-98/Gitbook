
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Binder communication related · CS Blog</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="leah">
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-accordion/accordion.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search-pro/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Brief Introduction to MediaSession and Command Transmission and Support.html" />
    
    
    <link rel="prev" href="../" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    English
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1" data-path="../">
            
                <a href="../">
            
                    
                    [engineering practice]
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1.1" data-path="../[Engineering Practice]/Setting Up Gitbook Full Process and Pitfall Record.html">
            
                <a href="../[Engineering Practice]/Setting Up Gitbook Full Process and Pitfall Record.html">
            
                    
                    Setting up gitbook full process and pitfall record
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.1.2" data-path="../">
            
                <a href="../">
            
                    
                    [problem solving]
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.2.1" data-path="../[Problem Solving]/The program packaged with PyInstaller that depends on apkutils cannot run.html">
            
                <a href="../[Problem Solving]/The program packaged with PyInstaller that depends on apkutils cannot run.html">
            
                    
                    The program packaged with pyinstaller that depends on apkutils cannot run
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.1.3" data-path="../">
            
                <a href="../">
            
                    
                    [source code reading]
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.3.1" data-path="../[Source Code Reading]/[PMS] Why do downgraded system pre-installed applications revert after a reboot.html">
            
                <a href="../[Source Code Reading]/[PMS] Why do downgraded system pre-installed applications revert after a reboot.html">
            
                    
                    [pms] why do downgraded system pre-installed applications revert after a reboot
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.3.2" data-path="../[Source Code Reading]/[PM] What does passing 0 to PackageManager.getPackageInfo as a Flag mean.html">
            
                <a href="../[Source Code Reading]/[PM] What does passing 0 to PackageManager.getPackageInfo as a Flag mean.html">
            
                    
                    [pm] what does passing 0 to packagemanager.getpackageinfo as a flag mean
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.1.4" data-path="../">
            
                <a href="../">
            
                    
                    [technique investigation]
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.1.4.1" data-path="Binder Communication Related.html">
            
                <a href="Binder Communication Related.html">
            
                    
                    Binder communication related
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.4.2" data-path="Brief Introduction to MediaSession and Command Transmission and Support.html">
            
                <a href="Brief Introduction to MediaSession and Command Transmission and Support.html">
            
                    
                    Brief introduction to mediasession and command transmission and support
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../SUMMARY.html">
            
                <a href="../../SUMMARY.html">
            
                    
                    Summary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../">
            
                <a href="../../">
            
                    
                    _book
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../_book/README.md">
            
                <span>
            
                    
                    English
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../../_book/English/README.md">
            
                <span>
            
                    
                    [engineering practice]
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1.1" data-path="../../_book/English/[Engineering Practice]/Setting Up Gitbook Full Process and Pitfall Record.md">
            
                <span>
            
                    
                    Setting up gitbook full process and pitfall record
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="../../_book/English/README.md">
            
                <span>
            
                    
                    [source code reading]
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.2.1" data-path="../../_book/English/[Source Code Reading]/What does passing 0 to PackageManager.getPackageInfo as a Flag mean.md">
            
                <span>
            
                    
                    What does passing 0 to packagemanager.getpackageinfo as a flag mean
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../../_book/README.md">
            
                <span>
            
                    
                    Gitbook
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="../../_book/gitbook/README.md">
            
                <span>
            
                    
                    Fonts
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1.1" data-path="../../_book/gitbook/fonts/README.md">
            
                <span>
            
                    
                    Fontawesome
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="../../_book/gitbook/README.md">
            
                <span>
            
                    
                    Gitbook-plugin-accordion
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="../../_book/gitbook/README.md">
            
                <span>
            
                    
                    Gitbook-plugin-fontsettings
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.4" data-path="../../_book/gitbook/README.md">
            
                <span>
            
                    
                    Gitbook-plugin-highlight
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.5" data-path="../../_book/gitbook/README.md">
            
                <span>
            
                    
                    Gitbook-plugin-lunr
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.6" data-path="../../_book/gitbook/README.md">
            
                <span>
            
                    
                    Gitbook-plugin-search-pro
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.7" data-path="../../_book/gitbook/README.md">
            
                <span>
            
                    
                    Gitbook-plugin-sharing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.8" data-path="../../_book/gitbook/README.md">
            
                <span>
            
                    
                    Gitbook-plugin-tbfed-pagefooter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.9" data-path="../../_book/gitbook/README.md">
            
                <span>
            
                    
                    Images
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../../_book/README.md">
            
                <span>
            
                    
                    中文
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="../../_book/中文/README.md">
            
                <span>
            
                    
                    【工程实践】
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1.1" data-path="../../_book/中文/【工程实践】/搭建Gitbook全流程及踩坑记录.md">
            
                <span>
            
                    
                    搭建gitbook全流程及踩坑记录
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3.2" data-path="../../_book/中文/README.md">
            
                <span>
            
                    
                    【源码阅读】
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.2.1" data-path="../../_book/中文/【源码阅读】/PackageManager.getPackageInfo(">
            
                <span>
            
                    
                    Packagemanager.getpackageinfo()传入0作为flag意味着什么
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../">
            
                <a href="../../">
            
                    
                    中文
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../../中文/">
            
                <a href="../../中文/">
            
                    
                    【工程实践】
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../../中文/【工程实践】/搭建Gitbook全流程及踩坑记录.html">
            
                <a href="../../中文/【工程实践】/搭建Gitbook全流程及踩坑记录.html">
            
                    
                    搭建gitbook全流程及踩坑记录
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../../中文/">
            
                <a href="../../中文/">
            
                    
                    【技术调查】
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../../中文/【技术调查】/Binder通信相关.html">
            
                <a href="../../中文/【技术调查】/Binder通信相关.html">
            
                    
                    Binder通信相关
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="../../中文/【技术调查】/MediaSession简要介绍和命令传递与支持反馈.html">
            
                <a href="../../中文/【技术调查】/MediaSession简要介绍和命令传递与支持反馈.html">
            
                    
                    Mediasession简要介绍和命令传递与支持反馈
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../../中文/">
            
                <a href="../../中文/">
            
                    
                    【源码阅读】
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.1" data-path="../../中文/【源码阅读】/【PMS】为什么重启后，被降级的系统内置应用会还原.html">
            
                <a href="../../中文/【源码阅读】/【PMS】为什么重启后，被降级的系统内置应用会还原.html">
            
                    
                    【pms】为什么重启后，被降级的系统内置应用会还原
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.2" data-path="../../中文/【源码阅读】/【PM】PackageManager.getPackageInfo(">
            
                <span>
            
                    
                    【pm】packagemanager.getpackageinfo()传入0作为flag意味着什么
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../../中文/">
            
                <a href="../../中文/">
            
                    
                    【疑难解决】
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.4.1" data-path="../../中文/【疑难解决】/pyinstaller打包依赖apkutils的程序无法运行.html">
            
                <a href="../../中文/【疑难解决】/pyinstaller打包依赖apkutils的程序无法运行.html">
            
                    
                    Pyinstaller打包依赖apkutils的程序无法运行
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Binder communication related</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="topic-how-to-handle-calls-when-binder-connection-is-broken"><strong>Topic: How to Handle Calls When Binder Connection is Broken?</strong></h2>
<h3 id="further-reading"><strong>Further Reading</strong></h3>
<p><a href="https://cloud.tencent.com/developer/article/1741320" target="_blank">Principles of Android Cross-Process Exception Handling</a></p>
<h3 id="scenario-1-service-process-is-killed-during-method-execution"><strong>Scenario 1: Service Process is Killed During Method Execution</strong></h3>
<ul>
<li><strong>Result</strong>:
The client triggers a <code>DeadObjectException</code>. If the client does not handle this exception, it may lead to a fatal crash, causing the invocation to be lost.</li>
<li><strong>Countermeasure</strong>:
The client should implement exception handling to ensure it does not crash.</li>
</ul>
<hr>
<h3 id="scenario-2-service-process-throws-an-exception-unsupported-by-aidl-during-method-execution"><strong>Scenario 2: Service Process Throws an Exception Unsupported by AIDL During Method Execution</strong></h3>
<ul>
<li><strong>Result</strong>:
The AIDL method returns default values on the client side. The client does not receive the exception, the service process does not crash, and the Binder connection remains intact.</li>
<li><strong>Countermeasure</strong>:
Avoid throwing exception types in the Binder that cannot be processed across processes.</li>
</ul>
<hr>
<h3 id="scenario-3-service-process-throws-an-aidl-supported-exception-during-method-execution"><strong>Scenario 3: Service Process Throws an AIDL-Supported Exception During Method Execution</strong></h3>
<ul>
<li><strong>Result</strong>:
The exception is forwarded to the client and can be caught in the method call. The invocation is lost, but the service process does not crash. If the client does not shut down, the Binder connection remains intact.</li>
<li><strong>Countermeasure</strong>:
Avoid throwing exception types in the Binder that cannot be processed across processes.</li>
</ul>
<hr>
<h3 id="scenario-4-binder-connection-is-broken-before-method-execution"><strong>Scenario 4: Binder Connection is Broken Before Method Execution</strong></h3>
<ul>
<li><strong>Result</strong>:
The client triggers a <code>DeadObjectException</code>. If unhandled, it may lead to a fatal crash, causing the invocation to be lost.</li>
<li><strong>Countermeasure</strong>:
In the <code>onServiceDisconnected</code> callback, set the Binder reference to null. All Binder calls must first check if the Binder is null.</li>
</ul>
<hr>
<h2 id="topic-only-nine-exception-types-are-supported-in-binder-inter-process-communication"><strong>Topic: Only Nine Exception Types are Supported in Binder Inter-Process Communication</strong></h2>
<ol>
<li><strong>In inter-process communication, only the following nine types of exceptions can be transferred between processes</strong>:<ul>
<li><code>SecurityException</code></li>
<li><code>BadParcelableException</code></li>
<li><code>IllegalArgumentException</code></li>
<li><code>NullPointerException</code></li>
<li><code>IllegalStateException</code></li>
<li><code>NetworkOnMainThreadException</code></li>
<li><code>UnsupportedOperationException</code></li>
<li><code>ServiceSpecificException</code></li>
<li>Parcelable exceptions</li>
</ul>
</li>
<li><strong>For unsupported exceptions, they are handled internally in the program. This may cause crashes, but they will not be passed to the other process. Examples of unsupported exceptions include</strong>:<ul>
<li>Runtime exceptions: <code>RuntimeException</code></li>
<li>Arithmetic exceptions: <code>ArithmeticException</code></li>
<li>Type casting exceptions: <code>ClassCastException</code></li>
<li>Array index out-of-bounds exceptions: <code>ArrayIndexOutOfBoundsException</code></li>
<li>File not found exceptions: <code>FileNotFoundException</code></li>
<li>String-to-number conversion exceptions: <code>NumberFormatException</code></li>
<li>Input/output exceptions: <code>IOException</code></li>
<li>Method not found exceptions: <code>NoSuchMethodException</code></li>
</ul>
</li>
</ol>
<hr>
<h2 id="topic-why-does-binder-only-require-a-single-data-copy"><strong>Topic: Why Does Binder Only Require a Single Data Copy?</strong></h2>
<p>In Linux, processes are isolated and cannot communicate directly. When process A sends data to process B, the data is first copied from the user space of A to the kernel space and then from the kernel space to the user space of B.</p>
<p><img src="Binder Communication Related_imgs/WMc6qL7vt9p.png" alt="img"></p>
<p>Binder communication uses the <code>mmap()</code> function to create a memory mapping between the kernel space and the receiving user space&apos;s data buffer. This allows process A to copy data directly to the memory buffer mapped to process B&apos;s user space, effectively achieving a single data copy.</p>
<p>Additionally, as Binder communication is bidirectional, a similar memory mapping is created for the data buffer of process A in the kernel space.</p>
<p><img src="Binder Communication Related_imgs/SWTymqDx5gh.png" alt="image-2024-9-20_17-57-45"> </p>
<footer class="page-footer"><span class="copyright">Copyright &#xA9; Leah 2024 all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification">modified time:
2024-12-11 15:22:18
</span></footer>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../" class="navigation navigation-prev " aria-label="Previous page: [technique investigation]">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Brief Introduction to MediaSession and Command Transmission and Support.html" class="navigation navigation-next " aria-label="Next page: Brief introduction to mediasession and command transmission and support">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Binder communication related","level":"1.1.4.1","depth":3,"next":{"title":"Brief introduction to mediasession and command transmission and support","level":"1.1.4.2","depth":3,"path":"English/[Technique Investigation]/Brief Introduction to MediaSession and Command Transmission and Support.md","ref":"English/[Technique Investigation]/Brief Introduction to MediaSession and Command Transmission and Support.md","articles":[]},"previous":{"title":"[technique investigation]","level":"1.1.4","depth":2,"path":"English/README.md","ref":"English/README.md","articles":[{"title":"Binder communication related","level":"1.1.4.1","depth":3,"path":"English/[Technique Investigation]/Binder Communication Related.md","ref":"English/[Technique Investigation]/Binder Communication Related.md","articles":[]},{"title":"Brief introduction to mediasession and command transmission and support","level":"1.1.4.2","depth":3,"path":"English/[Technique Investigation]/Brief Introduction to MediaSession and Command Transmission and Support.md","ref":"English/[Technique Investigation]/Brief Introduction to MediaSession and Command Transmission and Support.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["accordion","search-pro","-search","tbfed-pagefooter"],"root":"/","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"Copyright &copy Leah 2024","modify_label":"modified time:","modift_format":"YYYY-MM-DD HH:mm:ss"},"accordion":{},"search-pro":{},"highlight":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"leah","page":{"title":"CS Blog"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{"authorName":"leah"},"title":"CS Blog","gitbook":"3.2.3"},"file":{"path":"English/[Technique Investigation]/Binder Communication Related.md","mtime":"2024-12-11T07:22:18.350Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2024-12-11T07:31:04.513Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-accordion/accordionSelector.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search-pro/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

